<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title> Challenge üíå</title>
    <style>
      /* =========================================================
         EDIT STYLES HERE
         - Colours: :root
         - Fonts: body
         - Card sizes: --card
         ========================================================= */
      :root{
        --bg1:#fff4f7;
        --bg2:#ffe6ee;
        --cream:#fff8f2;
        --pink:#ff4d8d;
        --pink2:#ff78a8;
        --red:#ff2d55;
        --text:#2b2b2b;
        --muted:#6a5a64;
        --card: 92px; /* mobile-first card size */
        --radius: 18px;
        --shadow: 0 12px 30px rgba(0,0,0,.10);
        --shadow-soft: 0 10px 22px rgba(0,0,0,.08);
          --ui-scale: 1.3; /* try 1.1, 1.2, 1.3 */
      }

      *{box-sizing:border-box}
      html,body{height:100%}
      body{
        margin:0;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
        color:var(--text);
        background: radial-gradient(1200px 800px at 20% 10%, var(--bg2), transparent 60%),
                    radial-gradient(900px 650px at 80% 30%, #ffd4e3, transparent 55%),
                    linear-gradient(180deg, var(--bg1), var(--cream));
        overflow-x:hidden;
      }

      /* Page shell */
      .app{
        min-height:100%;
        display:flex;
        align-items:stretch;
        justify-content:center;
        .app{ overflow-y: auto; }
      }
      .stage{
        width:min(980px, 100%);
        padding:20px 16px 36px;
        position:relative;
          transform: scale(var(--ui-scale));
  transform-origin: top center;
      }

      /* Smooth section transitions */
      .screen{
        background: rgba(255,255,255,.72);
        border: 1px solid rgba(255,255,255,.7);
        box-shadow: var(--shadow);
        border-radius: 28px;
        padding: 22px 16px;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        position:relative;
        overflow:hidden;
      }
      .fadeIn{
        animation: fadeIn .45s ease both;
      }
      @keyframes fadeIn{
        from{opacity:0; transform: translateY(8px)}
        to{opacity:1; transform: translateY(0)}
      }

      /* Typography */
      h1,h2,h3{margin:0 0 10px}
      h1{font-size: 28px; letter-spacing:-.4px}
      h2{font-size: 22px; letter-spacing:-.2px}
      p{margin: 0 0 14px; color:var(--muted); line-height:1.5}
      .center{ text-align:center }
      .subtle{
        font-size: 13px;
        color: rgba(106,90,100,.9);
      }

      /* Buttons */
      .btnRow{display:flex; gap:12px; flex-wrap:wrap; justify-content:center; margin-top:14px}
      .btn{
        appearance:none;
        border:0;
        border-radius: 999px;
        padding: 12px 18px;
        font-weight: 650;
        cursor:pointer;
        transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
        box-shadow: var(--shadow-soft);
        user-select:none;
        -webkit-tap-highlight-color: transparent;
      }
      .btn:active{ transform: translateY(1px) scale(.99) }
      .btnPrimary{
        background: linear-gradient(135deg, var(--pink), var(--red));
        color:white;
      }
      .btnGhost{
        background: rgba(255,255,255,.8);
        color: var(--text);
        border: 1px solid rgba(255,77,141,.25);
      }
      .btnPrimary:hover{ filter: brightness(1.03) }
      .btnGhost:hover{ background: rgba(255,255,255,.92) }

      /* Floating hearts background */
      .heartsLayer{
        position:absolute; inset:-20px;
        pointer-events:none;
        overflow:hidden;
        opacity:.55;
      }
      .heart{
        position:absolute;
        width: 16px; height:16px;
        transform: rotate(45deg);
        background: rgba(255,77,141,.35);
        border-radius: 4px;
        animation: floatUp linear infinite;
        filter: blur(.1px);
      }
      .heart::before,.heart::after{
        content:"";
        position:absolute;
        width:16px; height:16px;
        background: inherit;
        border-radius: 50%;
      }
      .heart::before{ left:-8px; top:0 }
      .heart::after{ top:-8px; left:0 }

      @keyframes floatUp{
        from{ transform: translateY(20px) rotate(45deg); opacity:0 }
        10%{ opacity:.75 }
        to{ transform: translateY(-110vh) rotate(45deg); opacity:0 }
      }

      /* Quiz */
      .quizWrap{ max-width: 720px; margin: 0 auto; }
      .pill{
        display:inline-flex;
        align-items:center;
        gap:8px;
        padding: 8px 12px;
        border-radius: 999px;
        background: rgba(255,77,141,.10);
        border: 1px solid rgba(255,77,141,.20);
        color: rgba(43,43,43,.9);
        font-weight: 650;
        font-size: 13px;
      }
      .question{
        margin-top: 14px;
        background: rgba(255,255,255,.78);
        border: 1px solid rgba(0,0,0,.05);
        border-radius: 20px;
        padding: 16px;
        box-shadow: 0 10px 22px rgba(0,0,0,.06);
        position:relative;
      }
      .qText{ font-size: 18px; color: var(--text); margin-bottom: 12px; }
      .options{
        display:grid;
        gap:10px;
      }
      .opt{
        text-align:left;
        padding: 12px 12px;
        border-radius: 16px;
        border: 1px solid rgba(255,77,141,.18);
        background: rgba(255,255,255,.9);
        cursor:pointer;
        box-shadow: 0 8px 18px rgba(0,0,0,.06);
        transition: transform .12s ease, border-color .12s ease;
      }
      .opt:hover{ transform: translateY(-1px); border-color: rgba(255,77,141,.35); }
      .opt:active{ transform: translateY(0); }

      .shake{
        animation: shake .22s ease-in-out 0s 2;
      }
      @keyframes shake{
        0%,100%{transform:translateX(0)}
        25%{transform:translateX(-6px)}
        75%{transform:translateX(6px)}
      }

      .hint{
        margin-top:12px;
        padding:10px 12px;
        border-radius: 14px;
        background: rgba(255,245,250,.9);
        border: 1px solid rgba(255,77,141,.18);
        color: rgba(70,60,66,.95);
        font-size: 13px;
      }

      /* Small heart pop feedback */
      .heartPop{
        position:absolute;
        right:16px;
        top:12px;
        width: 18px; height:18px;
        transform: rotate(45deg);
        background: rgba(255,45,85,.65);
        border-radius: 4px;
        animation: pop .45s ease both;
      }
      .heartPop::before,.heartPop::after{
        content:"";
        position:absolute;
        width:18px; height:18px;
        background: inherit;
        border-radius: 50%;
      }
      .heartPop::before{ left:-9px; top:0 }
      .heartPop::after{ top:-9px; left:0 }
      @keyframes pop{
        0%{ transform: scale(.6) rotate(45deg); opacity:0 }
        60%{ transform: scale(1.25) rotate(45deg); opacity:1 }
        100%{ transform: scale(1) rotate(45deg); opacity:0 }
      }

      /* Memory game */
      .memoryWrap{ max-width: 860px; margin: 0 auto; }
      .memoryTop{
        display:flex; gap:12px; flex-wrap:wrap;
        justify-content:space-between; align-items:center;
        margin-bottom: 12px;
      }
      .grid{
        display:grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 12px;
        justify-items:stretch;
      }

      .card{
        width: 100%;
        height: var(--card);
        perspective: 900px;
        position:relative;
      }
      .cardInner{
        position:absolute; inset:0;
        transform-style: preserve-3d;
        transition: transform .45s cubic-bezier(.2,.8,.2,1);
        border-radius: 18px;
      }
      .card.flipped .cardInner{ transform: rotateY(180deg) }
      .face{
        position:absolute; inset:0;
        backface-visibility:hidden;
        border-radius: 18px;
        display:flex;
        align-items:center;
        justify-content:center;
        padding: 10px;
        border: 1px solid rgba(255,77,141,.18);
        box-shadow: 0 10px 18px rgba(0,0,0,.07);
      }
      .back{
        background: radial-gradient(110px 70px at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.75)),
                    linear-gradient(135deg, rgba(255,77,141,.22), rgba(255,45,85,.18));
        color: rgba(43,43,43,.85);
        font-weight: 800;
        letter-spacing:.2px;
      }
      .backIcon{
        font-size: 22px;
        transform: translateY(-1px);
        opacity:.9;
      }
      .front{
        transform: rotateY(180deg);
        background: rgba(255,255,255,.92);
        color: rgba(43,43,43,.9);
        font-weight: 750;
        text-align:center;
      }
      .photoBox{
        width:100%;
        height:100%;
        border-radius: 14px;
        border: 1px dashed rgba(255,77,141,.35);
        display:flex;
        align-items:center;
        justify-content:center;
        padding: 10px;
        background: rgba(255,244,247,.6);
        position:relative;
        overflow:hidden;
      }
      /* =========================================================
         INSERT COUPLE PHOTOS HERE (Memory Game)
         - Replace background-image urls for each .photoBox via inline style.
         - If you add images, set:
           backgroundImage: 'url("YOUR_IMAGE.jpg")'
         ========================================================= */
      .photoLabel{
        font-size: 12px;
        color: rgba(106,90,100,.95);
        line-height:1.25;
      }
      .captionToast{
        position:fixed;
        left:50%;
        bottom: 18px;
        transform: translateX(-50%);
        background: rgba(255,255,255,.92);
        border: 1px solid rgba(255,77,141,.22);
        box-shadow: var(--shadow-soft);
        padding: 10px 14px;
        border-radius: 999px;
        font-weight: 650;
        color: rgba(43,43,43,.9);
        animation: toast .25s ease both;
        z-index: 30;
      }
      @keyframes toast{
        from{opacity:0; transform: translateX(-50%) translateY(10px)}
        to{opacity:1; transform: translateX(-50%) translateY(0)}
      }

      /* Final proposal */
      .proposalWrap{
        min-height: 62vh;
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        text-align:center;
        gap: 10px;
        padding: 12px 8px 18px;
        position:relative;
      }
      .type{
        font-size: 16px;
        color: rgba(106,90,100,.95);
        min-height: 52px;
        max-width: 740px;
        line-height:1.55;
      }
      .bigAsk{
        font-size: clamp(28px, 5vw, 46px);
        letter-spacing:-.6px;
        margin-top: 2px;
      }

      /* NO button dodge area */
      .dodgeArea{
        width: min(760px, 100%);
        height: 140px;
        margin-top: 6px;
        position:relative;
        border-radius: 22px;
        background: rgba(255,255,255,.55);
        border: 1px solid rgba(255,77,141,.14);
        overflow:hidden;
      }
      .yesBtn{
        position:absolute;
        left: 14px;
        top: 50%;
        transform: translateY(-50%);
      }
      .noBtn{
        position:absolute;
        left: 56%;
        top: 50%;
        transform: translate(-50%,-50%);
        transition: left .18s ease, top .18s ease, transform .18s ease;
      }

      /* After YES */
      .successMsg{
        font-weight: 800;
        font-size: 18px;
        color: rgba(43,43,43,.92);
        margin-top: 8px;
      }
      .collage{
  width:min(920px, 100%);
  display:grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 12px;
  margin: 16px auto 48px; /* adds space BELOW */
}

      .ph{
        border-radius: 18px;
        min-height: 118px;
        background: rgba(255,255,255,.9);
        border: 1px dashed rgba(255,77,141,.35);
        box-shadow: 0 10px 18px rgba(0,0,0,.06);
        overflow:hidden;
        position:relative;
        animation: floatIn .45s ease both;
      }
      .ph::after{
        content: attr(data-label);
        position:absolute;
        bottom: 24px;
        left: 10px;
        right: 10px;
        padding: 8px 10px;
        border-radius: 999px;
        background: rgba(255,255,255,.92);
        border: 1px solid rgba(255,77,141,.18);
        color: rgba(106,90,100,.95);
        font-weight: 650;
        font-size: 12px;
        width: fit-content;
        max-width: calc(100% - 20px);
        white-space: nowrap;
        overflow:hidden;
        text-overflow: ellipsis;
      }
      @keyframes floatIn{
        from{opacity:0; transform: translateY(10px) scale(.98)}
        to{opacity:1; transform: translateY(0) scale(1)}
      }

      /* Confetti */
      .confetti{
        position:fixed;
        inset:0;
        pointer-events:none;
        overflow:hidden;
        z-index: 40;
      }
      .confettiPiece{
        position:absolute;
        width: 10px; height: 14px;
        opacity:.9;
        transform: translateY(-20px) rotate(0deg);
        animation: confettiFall linear forwards;
        border-radius: 3px;
      }
      @keyframes confettiFall{
        to{
          transform: translateY(110vh) rotate(720deg);
          opacity:1;
        }
      }

      /* Desktop tweaks */
      @media (min-width: 520px){
        .stage{ padding: 26px 18px 44px }
        .screen{ padding: 26px 22px }
        :root{ --card: 112px; }
        .grid{ grid-template-columns: repeat(4, 1fr); }
        .collage{ grid-template-columns: repeat(3, 1fr); }
      }
      @media (min-width: 820px){
        :root{ --card: 126px; }
        .collage{ grid-template-columns: repeat(4, 1fr); }
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <!-- React (allowed). No other libraries used. -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <script>
      (function(){
        const { useEffect, useMemo, useRef, useState } = React;

        /* =========================================================
           EDIT TEXT HERE (optional)
           ========================================================= */
        const COPY = {
          landingTitle: "Before I ask you something important‚Ä¶",
          landingBody: "there are two little challenges you have to complete üíå",
          startBtn: "Start the challenge",
          quizPerfect: "Perfect score üíñ You really do know us.",
          quizContinue: "Continue",
          memLine: "Every memory leads back to you.",
          memBtn: "One last thing‚Ä¶",
          typeLines: [
            "You passed every challenge‚Ä¶",
            "You know us.",
            "You remember us.",
            "So now I just have to ask‚Ä¶"
          ],
          ask: "Will you be my Valentine? ‚ù§Ô∏è",
          yes: "YES üíñ",
          no: "NO",
          yesMsg: "Best answer I could‚Äôve hoped for üíï"
        };

        /* =========================================================
           GAME 1 ‚Äî EXACT QUESTIONS & ANSWERS (do not change)
           ========================================================= */
        const QUIZ = [
          {
            q: "Where did we first properly meet?",
            options: ["At a party", "Through friends", "School", "Online"],
            answerIndex: 2
          },
          {
            q: "Which sentence best describes us?",
            options: ["Two people who found each other", "Best friends who fell in love", "A couple who grew together", "Soulmates from the start"],
            answerIndex: 1
          },
          {
            q: "What was our first date?",
            options: ["Dinner", "Walk", "Cinema", "Shopping"],
            answerIndex: 2
          },
          {
            q: "How old was I when we started dating?",
            options: ["14", "15", "16", "17"],
            answerIndex: 1
          },
          {
            q: "What is my favourite thing to eat?",
            options: ["McDonald‚Äôs", "Nando‚Äôs", "Pepe‚Äôs", "KFC"],
            answerIndex: 2
          }
        ];

        /* =========================================================
           GAME 2 ‚Äî MEMORY CARDS
           - 12 cards total (6 pairs)
           - Photo placeholders labelled so you can insert your photos
           - Add backgroundImage URLs in MEMORY_PAIRS below if you want
           ========================================================= */
        const MEMORY_PAIRS = [
          { id: "p1", label: "Couple Photo 1", caption: "That one moment I always replay üíó", img: "img/img1.jpg" },
          { id: "p2", label: "Couple Photo 2", caption: "We make ordinary feel rare ‚ú®", img: "img/img2.jpg" },
          { id: "p3", label: "Couple Photo 3", caption: "Proof we are a good idea üòå", img: "img/img3.jpg" },
          { id: "p4", label: "Couple Photo 4", caption: "A memory I never want to lose üíû", img: "img/img4.jpg" },
          { id: "p5", label: "Couple Photo 5", caption: "My favourite kind of chaos üíò", img: "img/img5.jpg" },
          { id: "p6", label: "Couple Photo 6", caption: "You always felt like home üè°", img: "img/img6.jpg" }
        ];

        function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

        function makeHearts(count){
          const hearts = [];
          for(let i=0;i<count;i++){
            const left = Math.random()*100;
            const size = 10 + Math.random()*16;
            const dur = 7 + Math.random()*9;
            const delay = Math.random()*6;
            const opacity = 0.18 + Math.random()*0.35;
            hearts.push({left, size, dur, delay, opacity});
          }
          return hearts;
        }

        function shuffle(arr){
          const a = arr.slice();
          for(let i=a.length-1;i>0;i--){
            const j = Math.floor(Math.random()*(i+1));
            [a[i], a[j]] = [a[j], a[i]];
          }
          return a;
        }

        function useTypewriter(lines, start){
          const [text, setText] = useState("");
          const [done, setDone] = useState(false);

          useEffect(()=>{
            if(!start){ setText(""); setDone(false); return; }

            let cancelled = false;
            let lineIndex = 0;
            let charIndex = 0;

            function tick(){
              if(cancelled) return;

              const line = lines[lineIndex];
              const next = line.slice(0, charIndex+1);
              const prefix = lines.slice(0, lineIndex).join("\n") + (lineIndex>0 ? "\n" : "");
              setText(prefix + next);

              charIndex++;

              if(charIndex >= line.length){
                // pause, then go next line
                setTimeout(()=>{
                  if(cancelled) return;
                  lineIndex++;
                  charIndex = 0;
                  if(lineIndex >= lines.length){
                    setDone(true);
                    return;
                  }
                  tick();
                }, 520);
                return;
              }

              setTimeout(tick, 28 + Math.random()*24);
            }

            // initial delay
            const t = setTimeout(tick, 350);
            return ()=>{ cancelled = true; clearTimeout(t); };
          }, [start]);

          return { text, done };
        }

        function Confetti({ run }){
          const [pieces, setPieces] = useState([]);
          useEffect(()=>{
            if(!run){ setPieces([]); return; }
            const W = window.innerWidth;
            const newPieces = Array.from({length: 120}).map((_,i)=>{
              const left = Math.random()*W;
              const delay = Math.random()*0.5;
              const dur = 2.4 + Math.random()*1.8;
              const hue = Math.floor(330 + Math.random()*50) % 360; // pink/red-ish
              const w = 7 + Math.random()*8;
              const h = 10 + Math.random()*12;
              return { id:i, left, delay, dur, hue, w, h };
            });
            setPieces(newPieces);

            const cleanup = setTimeout(()=> setPieces([]), 4500);
            return ()=> clearTimeout(cleanup);
          }, [run]);

          if(!pieces.length) return null;
          return React.createElement("div", { className:"confetti" },
            pieces.map(p =>
              React.createElement("div", {
                key: p.id,
                className:"confettiPiece",
                style:{
                  left: p.left + "px",
                  top: "-20px",
                  width: p.w + "px",
                  height: p.h + "px",
                  background: `hsl(${p.hue} 90% 65%)`,
                  animationDuration: p.dur + "s",
                  animationDelay: p.delay + "s"
                }
              })
            )
          );
        }

        function Landing({ onStart }){
          const hearts = useMemo(()=>makeHearts(22), []);
          return React.createElement("div", { className:"screen fadeIn" },
            React.createElement("div", { className:"heartsLayer" },
              hearts.map((h, idx)=>React.createElement("div", {
                key: idx,
                className:"heart",
                style:{
                  left: h.left + "%",
                  bottom: (-10 - Math.random()*30) + "px",
                  width: h.size + "px",
                  height: h.size + "px",
                  opacity: h.opacity,
                  animationDuration: h.dur + "s",
                  animationDelay: h.delay + "s"
                }
              }))
            ),
            React.createElement("div", { className:"center" },
              React.createElement("h1", null, COPY.landingTitle),
              React.createElement("p", null, COPY.landingBody),
              React.createElement("div", { className:"btnRow" },
                React.createElement("button", { className:"btn btnPrimary", onClick:onStart }, COPY.startBtn)
              ),
              React.createElement("p", { className:"subtle", style:{marginTop:"12px"} }
              )
            )
          );
        }

        function Quiz({ onComplete }){
          const [index, setIndex] = useState(0);
          const [shake, setShake] = useState(false);
          const [msg, setMsg] = useState("");
          const [pop, setPop] = useState(false);
          const [perfect, setPerfect] = useState(false);

          const q = QUIZ[index];

          function handleAnswer(i){
            if(perfect) return;
            if(i === q.answerIndex){
              setMsg("");
              setPop(true);
              setTimeout(()=>setPop(false), 450);

              if(index === QUIZ.length - 1){
                setPerfect(true);
                return;
              }
              setTimeout(()=> setIndex(prev => prev + 1), 220);
            }else{
              setShake(true);
              setMsg("Hmm‚Ä¶ I think you know this one üòå try again");
              setTimeout(()=> setShake(false), 450);
            }
          }

          return React.createElement("div", { className:"screen fadeIn quizWrap" },
            React.createElement("div", { className:"center" },
              React.createElement("h2", null, "Game 1 ‚Äî How well do you know us?"),
              React.createElement("div", { className:"pill" }, `Question ${Math.min(index+1, 5)} of 5`)
            ),
            React.createElement("div", { className: "question" + (shake ? " shake" : "") },
              pop ? React.createElement("div", { className:"heartPop", "aria-hidden":true }) : null,
              perfect
                ? React.createElement(React.Fragment, null,
                    React.createElement("div", { className:"center" },
                      React.createElement("h3", null, COPY.quizPerfect),
                      React.createElement("div", { className:"btnRow" },
                        React.createElement("button", { className:"btn btnPrimary", onClick:onComplete }, COPY.quizContinue)
                      )
                    )
                  )
                : React.createElement(React.Fragment, null,
                    React.createElement("div", { className:"qText" }, q.q),
                    React.createElement("div", { className:"options" },
                      q.options.map((opt, i)=>
                        React.createElement("button", {
                          key: i,
                          className:"opt",
                          onClick: ()=>handleAnswer(i)
                        }, `${String.fromCharCode(65+i)}) ${opt}`)
                      )
                    ),
                    msg ? React.createElement("div", { className:"hint" }, msg) : null
                  )
            )
          );
        }

        function MemoryGame({ onComplete }){
          // Build 12 cards (6 pairs) then shuffle
          const initialDeck = useMemo(()=>{
            const cards = [];
            MEMORY_PAIRS.forEach(pair=>{
              cards.push({ key: pair.id + "_a", pairId: pair.id, label: pair.label, caption: pair.caption, img: pair.img, icon:"üíó" });
              cards.push({ key: pair.id + "_b", pairId: pair.id, label: pair.label, caption: pair.caption, img: pair.img, icon:"üíó" });
            });
            return shuffle(cards);
          }, []);

          const [deck, setDeck] = useState(initialDeck);
          const [flipped, setFlipped] = useState([]);   // indices currently flipped (max 2)
          const [matched, setMatched] = useState({});   // pairId true
          const [toast, setToast] = useState("");

          const foundCount = Object.keys(matched).length;

          useEffect(()=>{
            if(flipped.length !== 2) return;

            const [i1, i2] = flipped;
            const c1 = deck[i1], c2 = deck[i2];

            if(c1.pairId === c2.pairId){
              // match
              setMatched(prev => ({...prev, [c1.pairId]: true}));
              setToast(c1.caption);
              const t1 = setTimeout(()=> setToast(""), 1200);
              const t2 = setTimeout(()=> setFlipped([]), 520);
              return ()=>{ clearTimeout(t1); clearTimeout(t2); };
            }else{
              // unmatch
              const t = setTimeout(()=> setFlipped([]), 780);
              return ()=> clearTimeout(t);
            }
          }, [flipped, deck]);

          useEffect(()=>{
            if(foundCount === 6){
              // small pause then allow next
              // (button shown immediately too)
            }
          }, [foundCount]);

          function canFlip(idx){
            if(flipped.length >= 2) return false;
            const pairId = deck[idx].pairId;
            if(matched[pairId]) return false;
            if(flipped.includes(idx)) return false;
            return true;
          }

          function onFlip(idx){
            if(!canFlip(idx)) return;
            setFlipped(prev => prev.concat(idx));
          }

          return React.createElement("div", { className:"screen fadeIn memoryWrap" },
            React.createElement("div", { className:"memoryTop" },
              React.createElement("div", null,
                React.createElement("h2", null, "Game 2 ‚Äî Memory Flip"),
                React.createElement("p", { className:"subtle", style:{margin:0} }, "Find the matching pairs.")
              ),
              React.createElement("div", { className:"pill" }, `${foundCount} / 6 memories found`)
            ),
            React.createElement("div", { className:"grid" },
              deck.map((card, idx)=>{
                const isMatched = !!matched[card.pairId];
                const isFlipped = isMatched || flipped.includes(idx);
                return React.createElement("div", {
                  key: card.key,
                  className:"card" + (isFlipped ? " flipped" : ""),
                  onClick: ()=>onFlip(idx),
                  role:"button",
                  tabIndex: 0,
                  onKeyDown: (e)=>{ if(e.key==="Enter" || e.key===" "){ e.preventDefault(); onFlip(idx); } }
                },
                  React.createElement("div", { className:"cardInner" },
                    React.createElement("div", { className:"face back" },
                      React.createElement("div", { className:"backIcon", "aria-hidden":true }, "üíû")
                    ),
                    React.createElement("div", { className:"face front" },
                      React.createElement("div", {
                        className:"photoBox",
                        style: card.img ? {
                          backgroundImage: 'url("' + card.img + '")',
                          backgroundSize: "cover",
                          backgroundPosition: "center",
                          borderStyle: "solid",
                          borderColor: "rgba(255,77,141,.18)"
                        } : null
                      },
                        React.createElement("div", { className:"photoLabel" },
                          card.img
                            ? ""
                            : (
                              "Insert photo:\n" + card.label
                            )
                        )
                      )
                    )
                  )
                );
              })
            ),
            toast ? React.createElement("div", { className:"captionToast" }, toast) : null,

            foundCount === 6
              ? React.createElement("div", { className:"center", style:{marginTop:"60px"} },
                  React.createElement("h3", null, COPY.memLine),
                  React.createElement("div", { className:"btnRow" },
                    React.createElement("button", { className:"btn btnPrimary", onClick:onComplete }, COPY.memBtn)
                  )
                )
              : null
          );
        }

        function Proposal({ onYes }){
          const [startType, setStartType] = useState(true);
          const { text, done } = useTypewriter(COPY.typeLines, startType);

          const areaRef = useRef(null);
          const [noPos, setNoPos] = useState({ x: 0.56, y: 0.50 }); // percentage in area
          const [dodgeSeed, setDodgeSeed] = useState(0);

          function moveNoAway(clientX, clientY){
            const area = areaRef.current;
            if(!area) return;
            const rect = area.getBoundingClientRect();
            const mx = (clientX - rect.left) / rect.width;
            const my = (clientY - rect.top) / rect.height;

            // If pointer is close to NO, jump it away
            const dx = mx - noPos.x;
            const dy = my - noPos.y;
            const dist = Math.sqrt(dx*dx + dy*dy);

            if(dist < 0.22){
              // pick a new position far-ish from pointer
              const tries = 8;
              let best = {x:noPos.x, y:noPos.y, score:-1};
              for(let i=0;i<tries;i++){
                const x = 0.18 + Math.random()*0.70;
                const y = 0.28 + Math.random()*0.44;
                const s = Math.sqrt((x-mx)**2 + (y-my)**2);
                if(s > best.score) best = {x,y,score:s};
              }
              setNoPos({ x: best.x, y: best.y });
              setDodgeSeed(s=>s+1);
            }
          }

          function onMouseMove(e){
            moveNoAway(e.clientX, e.clientY);
          }
          function onTouchMove(e){
            if(!e.touches || !e.touches[0]) return;
            moveNoAway(e.touches[0].clientX, e.touches[0].clientY);
          }

          // Prevent NO clicks (impossible to click)
          function blockNo(e){
            e.preventDefault();
            e.stopPropagation();
            // also move it as a playful response
            const area = areaRef.current;
            if(area){
              const rect = area.getBoundingClientRect();
              moveNoAway(rect.left + rect.width*Math.random(), rect.top + rect.height*Math.random());
            }
          }

          return React.createElement("div", { className:"screen fadeIn" },
            React.createElement("div", { className:"proposalWrap" },
              React.createElement("h2", null, "Final Page"),
              React.createElement("div", { className:"type", style:{whiteSpace:"pre-line"} }, text),
              React.createElement("div", { className:"bigAsk" }, done ? COPY.ask : ""),
              React.createElement("div", {
                ref: areaRef,
                className:"dodgeArea",
                onMouseMove,
                onTouchMove
              },
                React.createElement("button", { className:"btn btnPrimary yesBtn", onClick:onYes }, COPY.yes),
                React.createElement("button", {
                  className:"btn btnGhost noBtn",
                  onMouseEnter: (e)=>moveNoAway(e.clientX, e.clientY),
                  onMouseDown: blockNo,
                  onClick: blockNo,
                  onTouchStart: (e)=>{ onTouchMove(e); blockNo(e); },
                  style:{
                    left: (noPos.x*100) + "%",
                    top: (noPos.y*100) + "%"
                  },
                  "aria-label":"No (playfully impossible)"
                }, COPY.no)
              ),
              React.createElement("p", { className:"subtle", style:{marginTop:"10px"} },
                "The proposal unlocks only after both games are completed."
              )
            )
          );
        }

        function AfterYes(){
          // =========================================================
          // INSERT COUPLE PHOTOS HERE (Collage)
          // - Replace the `img` fields below with your image URLs/paths
          // - Example: img: "images/us1.jpg"
          // =========================================================
          const collage = [
            {  img: "img/img7.jpg" },
            {  img: "img/img8.jpg" },
            {  img: "img/img9.jpg" },
            {  img: "img/img10.jpg" },
            {  img: "img/img11.jpg" },
            {  img: "img/img12.jpg" },
            {  img: "img/img13.jpg" },
            {  img: "img/img14.jpg" }
          ];

          return React.createElement("div", { className:"screen fadeIn" },
            React.createElement("div", { className:"center" },
              React.createElement("h2", null, "Yesss üíñ"),
              React.createElement("div", { className:"successMsg" }, COPY.yesMsg),
              React.createElement("p", null, "Now come see the little collage I made for us.")
            ),
            React.createElement("div", { className:"collage" },
              collage.map((c, i)=>
                React.createElement("div", {
                  key: i,
                  className:"ph",
                  "data-label": c.label,
                  style: c.img ? {
                    backgroundImage: 'url("' + c.img + '")',
                    backgroundSize: "cover",
                    backgroundPosition: "center",
                    animationDelay: (i*70) + "ms",
                    borderStyle: "solid",
                    borderColor: "rgba(255,77,141,.18)"
                  } : { animationDelay: (i*70) + "ms" }
                })
              )
            ),
            React.createElement("p", { className:"subtle center", style:{marginTop:"14px"} },
              
            )
          );
        }

        function App(){
          // Flow: landing -> quiz -> memory -> proposal -> yes
          const [step, setStep] = useState("landing");
          const [quizDone, setQuizDone] = useState(false);
          const [memoryDone, setMemoryDone] = useState(false);
          const [confetti, setConfetti] = useState(false);

          function goQuiz(){ setStep("quiz"); }
          function quizComplete(){
            setQuizDone(true);
            setStep("memory");
          }
          function memoryComplete(){
            setMemoryDone(true);
            setStep("proposal");
          }
          function onYes(){
            // Proposal unlock condition: both games completed successfully
            if(!quizDone || !memoryDone) return;
            setConfetti(true);
            setStep("yes");
            setTimeout(()=> setConfetti(false), 4800);
          }

          return React.createElement("div", { className:"app" },
            React.createElement(Confetti, { run: confetti }),
            React.createElement("div", { className:"stage" },
              step === "landing" ? React.createElement(Landing, { onStart: goQuiz }) : null,
              step === "quiz" ? React.createElement(Quiz, { onComplete: quizComplete }) : null,
              step === "memory" ? React.createElement(MemoryGame, { onComplete: memoryComplete }) : null,
              step === "proposal" ? React.createElement(Proposal, { onYes }) : null,
              step === "yes" ? React.createElement(AfterYes, null) : null
            )
          );
        }

        const root = ReactDOM.createRoot(document.getElementById("root"));
        root.render(React.createElement(App));
      })();
    </script>
  </body>
</html>



